Index: main.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import telebot\r\nimport threading\r\nfrom config import TG_API_KEY\r\nfrom log_funcs import logger\r\n\r\nbot=telebot.TeleBot(TG_API_KEY)\r\ninit_bot(bot)\r\n# Запуск в отдельном потоке, чтобы не блокировать работу бота\r\nthreading.Thread(target=lambda: schedule_poll(bot), daemon=True).start()\r\n\r\n#print(\"bot is running\")\r\nlogger.info(\"bot is running\")\r\nbot.infinity_polling(timeout=10, long_polling_timeout=5)
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/main.py b/main.py
--- a/main.py	(revision 302c975737dabe1819f7eb9696901e1e99f81011)
+++ b/main.py	(date 1747975467031)
@@ -1,13 +1,66 @@
+# import telebot
+# import threading
+# from config import TG_API_KEY
+# from log_funcs import logger
+#
+# bot=telebot.TeleBot(TG_API_KEY)
+# init_bot(bot)
+# # Запуск в отдельном потоке, чтобы не блокировать работу бота
+# threading.Thread(target=lambda: schedule_poll(bot), daemon=True).start()
+#
+# #print("bot is running")
+# logger.info("bot is running")
+# bot.infinity_polling(timeout=10, long_polling_timeout=5)
+
 import telebot
 import threading
 from config import TG_API_KEY
 from log_funcs import logger
+# from storage.db import init_db
+import time
+# from storage.db import engine, init_db
+from sqlalchemy import inspect
+from telebot import types
+import logging
+from urllib.parse import urlparse
+
+logger = logging.getLogger(__name__)
+
+
+# def check_tables():
+#     init_db()
+#     inspector = inspect(engine)
+#     print("Таблицы в БД:", inspector.get_table_names())
+#
+# check_tables()
+
+
+
+def main():
+    try:
+        # Инициализация БД (без пересоздания таблиц)
+        # init_db()
+        # check_tables()
 
-bot=telebot.TeleBot(TG_API_KEY)
-init_bot(bot)
-# Запуск в отдельном потоке, чтобы не блокировать работу бота
-threading.Thread(target=lambda: schedule_poll(bot), daemon=True).start()
+        bot = telebot.TeleBot(TG_API_KEY)
+
+        # threading.Thread(target=lambda: schedule_poll(bot), daemon=True).start()
 
-#print("bot is running")
-logger.info("bot is running")
-bot.infinity_polling(timeout=10, long_polling_timeout=5)
\ No newline at end of file
+        # Запуск бота
+
+        logger.info("Бот запущен")
+        bot.infinity_polling(long_polling_timeout=10)
+
+    except Exception as e:
+        logger.error(f"Ошибка в main: {e}")
+        raise
+
+
+if __name__ == "__main__":
+    main()
+    try:
+        # Удерживаем выполнение, чтобы бот работал
+        while True:
+            time.sleep(0.5)
+    except KeyboardInterrupt:
+        print("Бот остановлен.")
\ No newline at end of file
